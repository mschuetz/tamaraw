{% extends "layout.html" %}
{% block body %}
{% call db_navbar('') %}{%endcall%}

<div id="deleteDialog" class="modal hide fade">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
			&times;
		</button>
		<h3>Wirklich löschen?</h3>
	</div>
	<div class="modal-footer">
		<button class="btn" data-dismiss="modal" aria-hidden="true">
			Zurück
		</button>
		<form method="post" action="{{url_for('delete_image', store_key=image.store_key)}}" class="span1">
			<button class="btn btn-danger" type="submit">
				Löschen
			</button>
		</form>
	</div>
</div>

<div id="commentDialog" class="modal hide fade">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
			&times;
		</button>
		<h3>Kommentar an den Autor</h3>
	</div>
	<form method="post" action="{{url_for('comment', store_key=image.store_key)}}">
		<div class="modal-body">
			<p>Hinweis: Ihr Kommentar wird nicht öffentlich angezeigt und ist nur dem Autor zugänglich.</p>
			<p>
				<input class="span6" type="text" name="real_name" placeholder="Name" value=""/>
				<input class="span6 hide" type="text" name="name" placeholder="Name" value=""/>
			</p>
			<p><input class="span6" type="email" name="email" placeholder="Emailadresse" value=""></p>
			<p><textarea class="span6" name="text" placeholder="Kommentar" rows="10" cols="80"></textarea></p>
		</div>
		<div class="modal-footer">
			<a class="btn" data-dismiss="modal" aria-hidden="true">
				Zurück
			</a>
			<button class="btn btn-primary" type="submit">
				Absenden
			</button>
		</div>
	</form>
</div>

<h3>{{image.prop_title}}</h3>
{% if in_result_set %}
<p>in {{ result_set_title }}</p>
{% endif %}
<div class="row">
	<div class="span6">
		<dl class="dl-horizontal">
			{% for prop in view_props %}
			<dt>
				{{prop.human_name}}
			</dt>
			<dd>
				{% if prop.type=='array' %}
					<ul class="property_list">
					{% for item in prop.value %}
						<li>
							{{item | markdown}}
							{% if item and prop.use_for_browse %}
							<a href="{{url_for('browse', short_key=prop.key | replace('prop_', ''), value=item)}}">
								<i class="icon-search icon-gray"></i>
							</a>
							{% endif %}
						</li>
					{% endfor %}
					</ul>
				{% else %}
					{% if prop.type=='text' %}
						{{prop.value | markdown}}
					{% else %}
						{{prop.value or ("&nbsp;") | safe}}
					{% endif %}
					{% if prop.value and prop.use_for_browse %}
					<a href="{{url_for('browse', short_key=prop.key | replace('prop_', ''), value=prop.value)}}">
						<i class="icon-search icon-gray "></i>
					</a>
					{% endif %}
				{% endif %}
			</dd>
			{% endfor %}
			<dt>Empfohlene Zitierweise</dt>
			<dd>„{{image.prop_title}}{% if image.prop_location or image.prop_creation_year%}, {%endif%}{{[image.prop_location, image.prop_creation_year]|filter|join(', ')}}“
				in: Bilderarchiv Rinderanspannung &lt;{{request.base_url}}&gt; (Stand: {{(image.updated_at or image.created_at) | date_format}})</dd>
		</dl>
		{% if 'username' in session %}
			<a href="{{url_for('edit_image', store_key=image.store_key)}}" class="btn btn-primary span1"> Edit </a>
			<a href="#deleteDialog" data-toggle="modal" class="span1 btn btn-danger"> Delete </a>
		{% endif %}
		<span class="span1">
			<a href="#commentDialog" data-toggle="modal" class="btn"> Kommentieren </a>
		</span>
	</div>
	<div class="span6">
		<div class="thumbnail">
			<a title="Original" href="{{ url_for('get_image', store_key=image.store_key) }}"> <img src="{{ url_for('get_image', store_key=image.store_key, x=640, y=480) }}"/> </a>
			<p>
				hinzugefügt am {{ image.created_at | date_format }}
			</p>
		</div>
	</div>
</div>
{% if in_result_set %}
{% call pager('') %}{%endcall%}
{% endif %}
{% endblock %}
