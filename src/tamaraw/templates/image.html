{% extends "layout.html" %}
{% block body %}
{% call db_navbar('') %}{%endcall%}

<div id="deleteDialog" class="modal hide fade">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
			&times;
		</button>
		<h3>Really delete?</h3>
	</div>
	<div class="modal-footer">
		<button class="btn" data-dismiss="modal" aria-hidden="true">
			Close
		</button>
		<form method="post" action="{{url_for('delete_image', store_key=image.store_key)}}" class="span1">
			<button class="btn btn-danger" type="submit">
				Delete
			</button>
		</form>
	</div>
</div>

<div id="commentDialog" class="modal hide fade">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
			&times;
		</button>
		<h3>Write a comment to the author</h3>
	</div>
	<form method="post" action="{{url_for('comment', store_key=image.store_key)}}">
		<div class="modal-body">
			<p><input type="text" name="name" placeholder="Your name" value=""/></p>
			<p><input type="email" name="email" placeholder="Your email address" value=""></p>
			<p><textarea name="text" placeholder="Your comment" rows="10" cols="810"></textarea></p>
		</div>
		<div class="modal-footer">
			<a class="btn" data-dismiss="modal" aria-hidden="true">
				Cancel
			</a>
			<button class="btn btn-primary" type="submit">
				Send
			</button>
		</div>
	</form>
</div>

<h3>{{image.prop_title}}</h3>
<div class="row">
	<div class="span6">
		<dl class="dl-horizontal">
			{% for prop in view_props %}
			<dt>
				{{prop.human_name}}
			</dt>
			<dd>
				{% if prop.type=='array' %}
					<ul class="property_list">
					{% for item in prop.value %}
						<li>
							{{item}}
							{% if item %}
							<a href="{{url_for('browse', key=prop.key, value=item)}}">
								<i class="icon-search icon-gray"></i>
							</a>
							{% endif %}
						</li>
					{% endfor %}
					</ul>
				{% else %}
					{{prop.value or "&nbsp;"|safe}}
					{% if prop.value %}
					<a href="{{url_for('browse', key=prop.key, value=prop.value)}}">
						<i class="icon-search icon-gray "></i>
					</a>
					{% endif %}
				{% endif %}
			</dd>
			{% endfor %}
		</dl>
		{% if 'username' in session %}
			<a href="{{url_for('edit_image', store_key=image.store_key)}}" class="btn btn-primary span1"> Edit </a>
			<a href="#deleteDialog" data-toggle="modal" class="span1 btn btn-danger"> Delete </a>
		{% endif %}
		<a href="#commentDialog" data-toggle="modal" class="span1 btn"> Comment </a>
	</div>
	<div class="span6">
		<div class="thumbnail">
			<a title="Original" href="{{ url_for('get_image', store_key=image.store_key) }}"> <img src="{{ url_for('get_image', store_key=image.store_key, x=640, y=480) }}"/> </a>
			<p>
				uploaded {{ image.created_at }}
			</p>
		</div>
	</div>
</div>
{% endblock %}
