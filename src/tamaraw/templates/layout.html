<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<title>Image Database</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="">
		<meta name="author" content="">
		<link href="{{url_for('static', filename='vendor/bootstrap/css/bootstrap.min.css') }}" rel="stylesheet">
		<link href="{{url_for('static', filename='vendor/bootstrap/css/bootstrap-responsive.min.css') }}" rel="stylesheet">
		<link href="{{url_for('static', filename='vendor/plupload/jquery.plupload.queue/css/jquery.plupload.queue.css') }}" rel="stylesheet">
		<link href="{{url_for('static', filename='tamaraw.css') }}" rel="stylesheet">
		<style>
			body {
				padding-top: 60px; /* 60px to make the container go all the way
				 to the bottom of the topbar */
			}
		</style>
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js">
		</script>
		<![endif]-->
	</head>

	<body>
		<script src="{{url_for('static', filename='vendor/jquery-1.8.3.min.js') }}"></script>
		<script src="{{url_for('static', filename='vendor/underscore-min.js') }}"></script>
		<nav class="navbar navbar-fixed-top navbar-inverse">
			<div class="navbar-inner">
				<div class="container-fluid">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"> <span class="icon-bar"> </span> <span class="icon-bar"> </span> <span class="icon-bar"> </span> </a>
					<a class="brand" href="/"> Rinderanspannung </a>
					<div class="nav-collapse">
						<ul class="nav">
							<li>
								<a href="{{url_for('recent_images')}}"> Bilddatenbank </a>
							</li>
							<li>
								<a href="{{url_for('site', template='about')}}"> Über diese Seite </a>
							</li>
							<li>
								<a href="{{url_for('site', template='imprint')}}"> Impressum </a>
							</li>
						</ul>
					</div>
					{% if 'username' in session %}
					<div class="btn-group pull-right">
						<a class="btn dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon-user" /></i>&nbsp;{{session['username']}}</a>
						<ul class="dropdown-menu">
							<li>
								<a href="{{url_for('comments')}}">Kommentare</a>
							</li>
							<li class="divider"></li>
							<li>
								<a href="{{url_for('logout')}}">Logout</a>
							</li>
						</ul>
					</div> 
					{% else %}
					<form class="navbar-form pull-right" action="{{url_for('login')}}" method="post">
						<input name="username" placeholder="Username" class="span2" type="text">
						<input name="password" placeholder="Password" class="span2" type="password">
						<button class="btn">
							Log in
						</button>
					</form>
					{% endif %}
				</div>
			</div>
		</nav>

{% macro db_navbar(active) %}
<nav class="navbar">
	<div class="navbar-inner">
		<ul class="nav">
			<li {% if active=='recent_images' %}class="active"{% endif %}>
				<a href="{{url_for('recent_images')}}">Neue Bilder</a>
			</li>
			<!--
			<li {% if active=='search' %}class="active"{% endif %}>
				<a href="#">Erweiterte Suche</a>
			</li>
			-->
			{% if 'username' in session %}
			<li {% if active=='upload' %}class="active"{% endif %}>
				<a href="{{url_for('upload_page')}}">Bilder hinzufügen</a>
			</li>
			{% endif %}
			<form class="navbar-search pull-right" method="get" action="{{ url_for('quick_search') }}">
				<input type="text" class="search-query" name="query" placeholder="Schnellsuche">
			</form>
		</ul>
	</div>
</nav>
{{ caller() }}
{% endmacro %}

{% macro pager(classes) %}
<ul class="pager {{classes}}">
	{% if prev_offset is defined %}
		<li class="previous"><a href="o{{prev_offset}}?{{request.query_string}}">
	{% else %}
		<li class="previous disabled"><a href="#">
	{% endif %}
	&larr; Zurück</a></li>
	{% if next_offset is defined %}
		<li class="next"><a href="./o{{next_offset}}?{{request.query_string}}">
	{% else %}
		<li class="next disabled"><a href="#">
	{% endif%}
	&rarr; Weiter</a></li>
</ul>
{{ caller() }}
{% endmacro %}


{% macro image_list(images, paging_target, prev_offset, next_offset) %}
{% for row in images|batch(4) %}
<ul class="thumbnails">
	{% for image in row %}
 	<li class="span3">
	<a href="{{ url_for('image_page', store_key=image.store_key) }}"> 		
		<div class="thumbnail">
			<img class="img-rounded" src="{{ url_for('get_image', store_key=image.store_key, x=400, y=300) }}"/>
			<p>{{ image.prop_title }}</p>
		</div>
	</a>
	</li>
	{% endfor %}
</ul>
{% endfor %}
{{ caller() }}
{% call pager('') %}{%endcall%}
{% endmacro %}
		<div class="container-fluid">
			{% with messages = get_flashed_messages(with_categories=true) %}
			{% if messages %}
			
			{% for category, message in messages %}
			
			<section id="flash{{loop.index-1}}" class="alert {{category}} hide">
				<button type="button" class="close" data-dismiss="alert"> × </button>
				{{message}}
			</section>
			{% endfor %}
			{% endif %}
			{% endwith %}

			{% block body %}{% endblock %}
		</div>
		<footer>
			<hr>
			© CK 2012
		</footer>
		<script src="{{url_for('static', filename='vendor/bootstrap/js/bootstrap.min.js') }}"></script>
		<script type="application/javascript">
			$(function(){
				$('.alert').slideDown('fast');
				$('.alert-success').delay(3000).slideUp('slow');
			}());
		</script>
	</body>

</html>